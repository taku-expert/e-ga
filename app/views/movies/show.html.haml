%body
  = link_to new_movie_comment_path(@movie.id), class:"post" do
    review
  .search-sort
    .select-wrap
      %select.sort_order{:name => "sort_order"}
        %option{:name => "location.pathname", :value => "location.pathname"}
          並び替え
        %option{:value => "rate_asc"}
          評価の低い順
        %option{:value => "rate_desc"}
          評価の高い順
        %option{:value => "created_at_asc"}
          投稿の古い順
        %option{:value => "created_at_desc"}
          投稿の新しい順
  .average
    - if @comments.length == 0
      まだレビューがありません
    - else
      .progress-bar
        .progress-bar__5
          %progress#Progress_5{max: "#{@progress}", value: "#{@progress}"} 0%
          = @progress
        .progress-bar__4
        .progress-bar__3
        .progress-bar__2
        .progress-bar__1
        .progress-bar__0
      %h3 このmovieの平均評価
      %h4
        .average-content
          #star-average
          | #{average = @comments.average(:rate).floor(1)}点
        :javascript
          $('#star-average').raty({
            size      : 36,
            starOff   : '#{asset_path('star-off.png')}',
            starOn    : '#{asset_path('star-on.png')}',
            starHalf  : '#{asset_path('star-half.png')}',
            half      : true,
            readOnly  : true,
            score     : #{average},
          });
        #average.contents
          = render @comments
